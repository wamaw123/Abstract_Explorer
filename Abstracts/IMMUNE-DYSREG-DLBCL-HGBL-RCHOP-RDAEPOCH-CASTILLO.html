<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="study:id" content="immune-dysreg-dlbcl-hgbl-castillo">
    <meta name="study:title" content="PB3210 - Immune dysregulation in DLBCL and HGBL with MYC, BCL2, and/or BCL6 rearrangements: A comparative analysis of R-CHOP versus R-DA-EPOCH regimens.">
    <meta name="study:fileName" content="Abstracts/IMMUNE-DYSREG-DLBCL-HGBL-RCHOP-RDAEPOCH-CASTILLO.html">
    <meta name="study:cancerTypes" content="DLBCL,HGBL,LBCL,B-NHL">
    <meta name="study:lineOfTherapy" content="1L"> <meta name="study:evidenceType" content="Real-world evidence"> <meta name="study:drugs" content="Rituximab,Monoclonal Antibody,Cyclophosphamide,Doxorubicin,Vincristine,Prednisone,Etoposide,Chemotherapy,CIT,R-CHOP,R-DA-EPOCH">

    <title>PB3210: Immune Dysregulation in DLBCL/HGBL (R-CHOP vs R-DA-EPOCH) (Castillo Godoy) - SOBI Themed</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="abstract_styles.css">
</head>
<body class="abstract-page-body">
    <div class="slide-container">
        <div class="visual-abstract-container">
            <h2 class="visual-abstract-title">Visual Summary: PB3210 - Immune Dysregulation in DLBCL/HGBL (R-CHOP vs R-DA-EPOCH)</h2>
            <div class="visual-abstract-grid">
                <div class="visual-abstract-item">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="var(--sobi-teal)"> <path d="M12 6.096c-1.058 0-2.02.468-2.704 1.248-.685.78-.996 1.788-.996 2.856s.311 2.076.996 2.856C9.98 13.84 10.942 14.31 12 14.31s2.02-.468 2.704-1.248.996-1.788.996-2.856-.311-2.076-.996-2.856C14.02 6.564 13.058 6.096 12 6.096zM12 12.81c-.53 0-1.008-.222-1.352-.588-.344-.366-.528-.852-.528-1.422s.184-1.056.528-1.422C10.992 9.012 11.47 8.79 12 8.79s1.008.222 1.352.588.528.852.528 1.422-.184-1.056-.528 1.422C13.008 12.588 12.53 12.81 12 12.81zm6.708 3.672A7.47 7.47 0 0012.024 15c-1.404 0-2.706.39-3.816 1.056A4.476 4.476 0 004.5 19.686V21h15v-1.314a4.476 4.476 0 00-3.792-3.624zM6.024 16.56c.84-.468 1.848-.768 2.904-.924A5.928 5.928 0 0112.024 15a5.928 5.928 0 013.096.636c1.056.156 2.064.456 2.904.924A2.988 2.988 0 0019.5 18.018V19.5h-15v-1.482a2.988 2.988 0 001.524-2.458zM4.5 7.032c0-1.068.312-2.076.996-2.856S7.2 3 8.256 3A7.47 7.47 0 0112.024 1.5c1.404 0 2.706.39 3.816 1.056A4.476 4.476 0 0119.5 6.186V7.5H4.5v-.468zM18 4.56c-.84.468-1.848.768-2.904-.924A5.928 5.928 0 0012.024 6a5.928 5.928 0 00-3.096.636 7.524 7.524 0 00-2.904.924A2.988 2.988 0 014.5 7.482V6H3V4.5A1.5 1.5 0 014.5 3h15A1.5 1.5 0 0121 4.5V6h-1.5v1.482a2.988 2.988 0 01-1.524 2.458L18 4.56z" />
                    </svg>
                    <h4>Population & Aim (N=57 Analyzed)</h4>
                    <p>DLBCL/HGBL Pts with MYC rearr. (±BCL2/BCL6). Aim: Assess immune impact of R-CHOP vs R-DA-EPOCH.</p>
                </div>
                <div class="visual-abstract-item">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="var(--sobi-teal)"> <path fill-rule="evenodd" d="M10.5 3.75a.75.75 0 01.75-.75h1.5a.75.75 0 01.75.75V4.5h3A2.25 2.25 0 0118.75 6.75v1.5a2.25 2.25 0 01-2.25 2.25H15.5V12h1.25a.75.75 0 010 1.5H15.5v1.5h.75a.75.75 0 010 1.5H15.5v1.5H18a.75.75 0 010 1.5h-2.5v1.5a.75.75 0 01-1.5 0V18h-1.5v1.5a.75.75 0 01-1.5 0V18h-1.5v1.5a.75.75 0 01-1.5 0v-3A2.25 2.25 0 016 14.25v-1.5A2.25 2.25 0 018.25 10.5H9.5V9H8.25A2.25 2.25 0 016 6.75v-1.5A2.25 2.25 0 018.25 3H10.5V3.75zm-1.5 6.75h6V6.75H9V10.5z" clip-rule="evenodd" />
                    </svg>
                    <h4>Intervention (Retrospective)</h4>
                    <p>R-CHOP (N=36) vs R-DA-EPOCH (N=20). Immune parameters pre/post treatment.</p>
                </div>
                <div class="visual-abstract-item">
                     <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="var(--sobi-orange)"> <path fill-rule="evenodd" d="M3.75 3A.75.75 0 003 3.75v16.5a.75.75 0 00.75.75h16.5a.75.75 0 00.75-.75V3.75a.75.75 0 00-.75-.75H3.75zm14.25 1.5H6v13.5h12V4.5zm-10.5 3a.75.75 0 000 1.5h9a.75.75 0 000-1.5h-9zm0 3.75a.75.75 0 000 1.5h9a.75.75 0 000-1.5h-9zm0 3.75a.75.75 0 000 1.5H9a.75.75 0 000-1.5H6z" clip-rule="evenodd" />
                    </svg>
                    <h4>Key Findings (Immune Impact)</h4>
                    <p>Cellular: No EOT diff. Trend ↓NK/CD4+ in R-DA-EPOCH. <br>Humoral: R-DA-EPOCH sig. ↓IgG & IgA (p=0.001).</p>
                </div>
                <div class="visual-abstract-item">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="var(--sobi-orange)"> <path fill-rule="evenodd" d="M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25zm.092 14.444a.75.75 0 01-.092 0l-3.75-3.75a.75.75 0 111.06-1.06L12 14.813l3.182-3.182a.75.75 0 111.06 1.06l-3.75 3.75a.75.75 0 01-.53.22z" clip-rule="evenodd" />
                    </svg>
                    <h4>Conclusion</h4>
                    <p>R-DA-EPOCH induces greater humoral immunosuppression. Baseline immune status important.</p>
                </div>
            </div>
        </div>

        <div class="text-center mb-8">
            <h1 class="abstract-header-title">PB3210 - Immune dysregulation in diffuse large B-cell lymphoma (DLBCL) and high-grade B-cell lymphoma (HGBL) with MYC, BCL2, and/or BCL6 rearrangements: A comparative analysis of R-CHOP versus R-DA-EPOCH regimens.</h1>
            <p class="abstract-sub-header">Macarena Castillo Godoy, Nicolás De Lucas Torres, Esther Martinez Fresno, et al.</p>
            <p class="abstract-meta-info mt-2">EHA 2025 Congress | Abstract #PB3210 | Publication Only</p>
        </div>

        <div class="grid md:grid-cols-2 gap-x-8 gap-y-6">
            <div>
                <div class="abstract-card">
                    <h2 class="abstract-section-title">Background</h2>
                    <ul class="list-disc list-inside text-sm space-y-1 pl-2">
                        <li>DLBCL/HGBL with MYC, BCL2/BCL6 rearrangements are aggressive with poor prognosis.</li>
                        <li>R-CHOP and R-DA-EPOCH have improved OS (50-70%), but their immune effects are unclear.</li>
                        <li>Treatment-induced immunosuppression (esp. with intensive regimens like R-DA-EPOCH) can increase infection risk due to neutropenia, T-cell depletion, and delayed immune reconstitution.</li>
                    </ul>
                </div>

                <div class="abstract-card">
                    <h2 class="abstract-section-title">Aims</h2>
                    <p class="text-sm mb-1">To assess the immunological impact of R-CHOP and R-DA-EPOCH in DLBCL/HGBL patients with MYC rearrangements (±BCL2/BCL6 changes) by evaluating lymphocyte subpopulations and immunoglobulin levels pre/post-treatment.</p>
                </div>

                <div class="abstract-card">
                    <h2 class="abstract-section-title">Methods & Study Design</h2>
                    <ul class="list-disc list-inside text-sm space-y-1 mb-3 pl-2">
                        <li>Retrospective, single-center study (Hospital Universitario Central de Asturias, HUCA).</li>
                        <li>Patients: 81 DLBCL/HGBL patients (2014-2024) with cytogenetic MYC alterations (FISH).</li>
                        <li>Analyzed Subset: 57 patients who received R-CHOP or R-DA-EPOCH.
                            <ul class="list-circle list-inside ml-4">
                                <li>R-CHOP group: N=36 (from Table 1)</li>
                                <li>R-DA-EPOCH group: N=20 (from Table 1)</li>
                            </ul>
                        </li>
                        <li>Parameters Assessed: Changes in lymphocyte subpopulations (CD4+ T cells, CD8+ T cells, NK cells, B cells) and immunoglobulin levels (IgG, IgA, IgM) before and after treatment.</li>
                        <li>Comparative statistical analyses conducted.</li>
                    </ul>
                     <div class="study-design-schema">
                        <h3 class="schema-title">Study Overview</h3>
                        <div class="schema-enrollment">
                            <strong>Patient Cohort (N=81)</strong>
                            <span>DLBCL/HGBL with MYC alterations (2014-2024)</span>
                        </div>
                        <div class="schema-arrow-down">▼</div>
                        <div class="schema-phase-group">
                            <div class="schema-phase" style="flex-basis: 100%; background-color: var(--sobi-light-gray-bg); border-color: var(--sobi-dark-blue);">
                                <strong>Analyzed Subset (N=57)</strong>
                                <span>Received R-CHOP or R-DA-EPOCH</span>
                            </div>
                        </div>
                        <div class="schema-arrow-down">▼</div>
                        <div class="schema-phase-group">
                            <div class="schema-phase" style="flex-basis: 48%; background-color: var(--sobi-light-teal-bg);">
                                <strong>R-CHOP Group (N=36)</strong>
                            </div>
                             <div style="writing-mode: vertical-rl; text-orientation: mixed; margin: auto 5px; font-weight:bold;">VS</div>
                            <div class="schema-phase" style="flex-basis: 48%; background-color: var(--sobi-light-orange-bg);">
                                <strong>R-DA-EPOCH Group (N=20)</strong>
                            </div>
                        </div>
                        <div class="schema-arrow-down">▼</div>
                        <div class="schema-assessment-points">
                           <span>Lymphocyte Subpopulations (Pre & Post)</span>
                           <span>Immunoglobulin Levels (IgG, IgA, IgM) (Pre & Post)</span>
                        </div>
                    </div>
                </div>
            </div>

            <div>
                <div class="abstract-card">
                    <h2 class="abstract-section-title">Immune Parameters (Baseline & Post-Treatment)</h2>
                    <p class="text-xs meta-info mb-2">Data from Table 1 (mean ± SD). N=36 for R-CHOP, N=20 for R-DA-EPOCH.</p>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr><th>Parameter</th><th>R-CHOP</th><th>R-DA-EPOCH</th><th>p-value</th></tr>
                            </thead>
                            <tbody>
                                <tr><td>Baseline Lymphocytes (cells/µL)</td><td>1,545.28 ± 716.22</td><td>4,821.50 ± 10,853.02</td><td>0.075</td></tr>
                                <tr><td>Baseline CD4+ T cells (cells/µL)</td><td>566.70 ± 457.76</td><td>267.25 ± 227.99</td><td>0.112</td></tr>
                                <tr><td>Final CD4+ T cells (cells/µL)</td><td>513.38 ± 347.17</td><td>281.57 ± 171.83</td><td>0.134</td></tr>
                                <tr><td>Baseline IgG (g/L)</td><td>9.73 ± 3.23</td><td>9.55 ± 7.60</td><td>0.908</td></tr>
                                <tr><td>Final IgG (g/L)</td><td>7.15 ± 2.47</td><td>4.12 ± 1.04</td><td class="highlight">0.001</td></tr>
                                <tr><td>Baseline IgA (g/L)</td><td>2.24 ± 0.75</td><td>1.72 ± 0.76</td><td>0.053</td></tr>
                                <tr><td>Final IgA (g/L)</td><td>1.53 ± 0.69</td><td>0.65 ± 0.47</td><td class="highlight">0.001</td></tr>
                                <tr><td>Baseline IgM (g/L)</td><td>3.50 ± 9.56</td><td>1.24 ± 1.67</td><td>0.416</td></tr>
                                <tr><td>Final IgM (g/L)</td><td>4.26 ± 11.64</td><td>1.00 ± 1.28</td><td>0.416</td></tr>
                                <tr><td>Baseline Neutrophils (cells/µL)</td><td>3,575.00 ± 2,406.39</td><td>3,096.02 ± 1,919.96</td><td>0.486</td></tr>
                            </tbody>
                        </table>
                         <p class="footnote-text mt-1">Abstract text also mentions NK cells and B cells, but these are not in the provided Table 1.</p>
                    </div>
                </div>

                <div class="abstract-card">
                    <h2 class="abstract-section-title">Results Summary</h2>
                    <p class="text-sm mb-2"><strong>Cellular Immunosuppression:</strong></p>
                    <ul class="list-disc list-inside text-sm space-y-1 pl-2 mb-3">
                        <li>No significant differences in total lymphocyte count, CD4+ T cells, CD8+ T cells, NK cells, or B cells between treatment groups at end of treatment (p>0.05).</li>
                        <li>Trend toward lower levels of NK and CD4+ T cells noted in R-DA-EPOCH group (particularly baseline levels for CD4+ from table).</li>
                    </ul>
                     <p class="text-sm mb-2"><strong>Humoral Immunosuppression (Post-Treatment):</strong></p>
                    <ul class="list-disc list-inside text-sm space-y-1 pl-2 mb-3">
                        <li>Significant reduction in IgG (p=0.001) and IgA (p=0.001) levels in R-DA-EPOCH group compared to R-CHOP.</li>
                        <li>IgM levels showed a more substantial decrease in R-DA-EPOCH group, but not statistically significant (p>0.05).</li>
                    </ul>
                    <div class="chart-container mb-6">
                        <svg id="immuneImpactChart" width="400" height="300"></svg>
                        <div id="immuneImpactLegend" class="legend"></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="abstract-card mt-6">
            <h2 class="abstract-section-title">Summary & Conclusion</h2>
            <ul class="list-disc list-inside text-sm space-y-1 pl-2">
                <li>R-DA-EPOCH induces greater humoral immunosuppression than R-CHOP (significant ↓ IgG & IgA), potentially increasing infection risk.</li>
                <li>Trend of ↓ NK and CD4+ cells in R-DA-EPOCH patients suggests those with baseline poor prognosis markers may have more aggressive disease and pre-existing immune alterations, influencing treatment response and post-chemo immunosuppression.</li>
                <li>Highlights importance of assessing baseline immune status and its impact on clinical outcomes in DLBCL/HGBL patients undergoing intensive immunochemotherapy.</li>
            </ul>
        </div>

        <div class="abstract-card mt-6 abbreviations-list">
            <p>AE, Adverse Event; ASCT, Autologous Stem Cell Transplant; BCL2, B-cell lymphoma 2; BCL6, B-cell lymphoma 6; CD, Cluster of Differentiation; CIT, Chemoimmunotherapy; CR, Complete Remission; DLBCL, Diffuse Large B-Cell Lymphoma; EOT, End of Treatment; EPOCH, Etoposide, Prednisone, Vincristine, Cyclophosphamide, Doxorubicin; FISH, Fluorescence In Situ Hybridization; HGBL, High-Grade B-Cell Lymphoma; HUCA, Hospital Universitario Central de Asturias; IgA, Immunoglobulin A; IgG, Immunoglobulin G; IgM, Immunoglobulin M; IPI, International Prognostic Index; MYC, Myelocytomatosis oncogene; NK, Natural Killer; OS, Overall Survival; PFS, Progression-Free Survival; PR, Partial Remission; R-CHOP, Rituximab, Cyclophosphamide, Doxorubicin, Vincristine, Prednisone; R-DA-EPOCH, Rituximab, Dose-Adjusted Etoposide, Prednisone, Vincristine, Cyclophosphamide, Doxorubicin; SD, Stable Disease.</p>
        </div>

        <div class="abstract-card mt-6 reference-section">
            <h2 class="abstract-section-title">
                Reference
                <button id="copyReferenceBtn" class="copy-reference-button" title="Copy Reference">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                        <path d="M7 3.5A1.5 1.5 0 018.5 2h3.879a1.5 1.5 0 011.06.44l3.122 3.121A1.5 1.5 0 0117 6.621V16.5a1.5 1.5 0 01-1.5 1.5h-7A1.5 1.5 0 017 16.5v-13z" />
                        <path d="M4.5 6A1.5 1.5 0 003 7.5v10A1.5 1.5 0 004.5 19h7a1.5 1.5 0 001.5-1.5v-2.5a.75.75 0 00-1.5 0v2.5a.5.5 0 01-.5.5h-7a.5.5 0 01-.5-.5v-10a.5.5 0 01.5-.5h2.5a.75.75 0 000-1.5H4.5z" />
                    </svg>
                    Copy
                </button>
            </h2>
            <p id="referenceSectionContent">
                Castillo Godoy M, De Lucas Torres N, Martinez Fresno E, et al. Immune dysregulation in diffuse large B-cell lymphoma (DLBCL) and high-grade B-cell lymphoma (HGBL) with MYC, BCL2, and/or BCL6 rearrangements: A comparative analysis of R-CHOP versus R-DA-EPOCH regimens. Abstract #PB3210 presented at European Haematology Association (EHA) June 12–15, 2025, Milan, Italy.
            </p>
        </div>

        <div class="abstract-footer-info">
            <p>EHA 2025 Congress | Abstract #PB3210 | Abstract Release: 05/14/2025 | Presentation: 06/12/2025</p>
            <p>For Research & Informational Purposes Only.</p>
        </div>
    </div>

    <script defer src="abstract_features.js"></script>
    <script>
        function drawImmuneImpactChart(containerId, legendContainerId) {
            const chartTitle = "Final Immunoglobulin Levels (g/L) Post-Treatment";
            // Data from Table 1 in the abstract image
            const chartData = [
                { group: "R-CHOP (N=36)", IgG: 7.15, IgA: 1.53, IgM: 4.26 },
                { group: "R-DA-EPOCH (N=20)", IgG: 4.12, IgA: 0.65, IgM: 1.00 }
            ];
            const p_values = { IgG: 0.001, IgA: 0.001, IgM: 0.416 };

            const svg = d3.select(containerId);
            const legendContainer = d3.select(legendContainerId);

            svg.selectAll("*").remove();
            legendContainer.selectAll("*").remove();

            let containerWidth = 400;
            const chartWrapper = svg.node() ? svg.node().closest('.chart-container') : null;
            if (chartWrapper) {
                containerWidth = Math.max(chartWrapper.getBoundingClientRect().width * 0.9, 300);
            }
            
            const svgWidth = containerWidth;
            const svgHeight = +svg.attr("height");

            const margin = { top: 50, right: 20, bottom: 70, left: 60 }; // Increased bottom margin
            const chartWidth = svgWidth - margin.left - margin.right;
            const chartHeight = svgHeight - margin.top - margin.bottom;

            if (chartWidth <= 0 || chartHeight <=0) return;

            const g = svg.append("g")
                .attr("transform", `translate(${margin.left},${margin.top})`);

            const groups = chartData.map(d => d.group); 
            const subgroups = ["IgG", "IgA", "IgM"]; 
            
            const xScaleGroups = d3.scaleBand()
                .domain(groups)
                .range([0, chartWidth])
                .padding(0.3);

            const xScaleSubgroups = d3.scaleBand()
                .domain(subgroups)
                .range([0, xScaleGroups.bandwidth()])
                .padding(0.1);

            const yScale = d3.scaleLinear()
                .domain([0, d3.max(chartData, d => d3.max(subgroups, key => d[key])) * 1.1 || 10]) // Dynamic Y-axis
                .range([chartHeight, 0]);

            const color = d3.scaleOrdinal()
                .domain(subgroups)
                .range(["var(--sobi-teal)", "var(--sobi-orange)", "var(--sobi-yellow)"]);

            g.append("g")
                .attr("transform", `translate(0,${chartHeight})`)
                .call(d3.axisBottom(xScaleGroups))
                .selectAll("text")
                .attr("class", "axis-text")
                .style("font-size", "10px")
                .attr("transform", "translate(0,5)");

            g.append("g")
                .call(d3.axisLeft(yScale).ticks(5).tickFormat(d => d.toFixed(1)))
                .selectAll("text")
                .attr("class", "axis-text")
                .style("font-size", "10px");

            g.append("g")			
                .attr("class", "grid")
                .call(d3.axisLeft(yScale)
                    .ticks(5)
                    .tickSize(-chartWidth)
                    .tickFormat("")
                )
                .selectAll("line")
                .style("stroke", "#e0e0e0")
                .style("stroke-opacity", "0.7");

            const groupBars = g.selectAll(".group-bar")
                .data(chartData)
                .enter().append("g")
                  .attr("class", "group-bar")
                  .attr("transform", d => `translate(${xScaleGroups(d.group)},0)`);

            groupBars.selectAll("rect")
                .data(d => subgroups.map(key => ({ key: key, value: d[key] })))
                .enter().append("rect")
                    .attr("x", d => xScaleSubgroups(d.key))
                    .attr("y", d => yScale(d.value))
                    .attr("width", xScaleSubgroups.bandwidth())
                    .attr("height", d => chartHeight - yScale(d.value))
                    .attr("fill", d => color(d.key))
                    .attr("rx", 2).attr("ry", 2);
            
            groupBars.selectAll(".bar-label")
                .data(d => subgroups.map(key => ({ key: key, value: d[key] })))
                .enter().append("text")
                .filter(d => d.value !== undefined)
                .attr("class", "chart-label")
                .attr("x", d => xScaleSubgroups(d.key) + xScaleSubgroups.bandwidth() / 2)
                .attr("y", d => yScale(d.value) - 5) 
                .attr("text-anchor", "middle")
                .style("font-size", "9px")
                .style("fill", "var(--sobi-dark-text)")
                .text(d => d.value.toFixed(2));
            
             // Add p-values below subgroups
            subgroups.forEach((subgroup, i) => {
                const p_text = `p=${p_values[subgroup].toFixed(3)}`;
                const significance_color = p_values[subgroup] < 0.05 ? "var(--sobi-orange)" : "var(--sobi-dark-text)";
                g.append("text")
                    .attr("class", "axis-text p-value-text")
                    .attr("x", chartWidth / subgroups.length * i + (chartWidth / subgroups.length / 2) - (xScaleGroups.paddingOuter() * chartWidth /2) ) // Adjust position
                    .attr("y", chartHeight + 35) // Position below x-axis labels
                    .attr("text-anchor", "middle")
                    .style("font-size", "9px")
                    .style("font-weight", p_values[subgroup] < 0.05 ? "bold" : "normal")
                    .style("fill", significance_color)
                    .text(`${subgroup}: ${p_text}`);
            });

            svg.append("text")
                .attr("x", svgWidth / 2)
                .attr("y", margin.top / 2)
                .attr("text-anchor", "middle")
                .style("font-size", "14px")
                .style("font-weight", "600")
                .style("fill", "var(--sobi-dark-blue)")
                .text(chartTitle);

            const legendData = subgroups.map(key => ({
                label: key,
                color: color(key)
            }));

            const legendItems = legendContainer.selectAll(".legend-item")
                .data(legendData).enter().append("div").attr("class", "legend-item");
            legendItems.append("div").attr("class", "legend-color-box").style("background-color", d => d.color);
            legendItems.append("span").text(d => d.label);
        }
        
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        };

        const debouncedDrawPB3210Chart = debounce(() => drawImmuneImpactChart("#immuneImpactChart", "#immuneImpactLegend"), 250);
        
        window.addEventListener('resize', debouncedDrawPB3210Chart);
        
        document.addEventListener('DOMContentLoaded', () => {
            debouncedDrawPB3210Chart();
        });
        if (document.readyState === "complete" || document.readyState === "interactive") {
             setTimeout(debouncedDrawPB3210Chart, 0); 
        }
    </script>
</body>
</html>
